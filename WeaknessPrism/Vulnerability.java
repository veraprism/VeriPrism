package WeaknessPrism;

/**
 * @author Billy The Kid IV
 *
 */
import java.io.FileWriter;
import java.io.IOException;

import org.json.simple.JSONObject;



public class Vulnerability {
/**
* @param weaknessId
* @param hashCode
* @param startLine
* @param endLine
* @param startCol
* @param endCol
*/
	
	public Vulnerability(String method) {
		super();

		this.weaknessId = 0;
		this.method = method;
		this.hashCode = 0;
		this.startLine = 0;
		this.endLine = 00;
		this.startCol = 0;
		this.endCol = 0;
		this.filename = "VPR-VLN-" + String.valueOf(this.weaknessId);

		}
	
	public Vulnerability(long weaknessId) {
		super();

		this.weaknessId = weaknessId;
		this.method = "";
		this.hashCode = 0;
		this.startLine = 0;
		this.endLine = 00;
		this.startCol = 0;
		this.endCol = 0;
		this.filename = "VPR-VLN-" + String.valueOf(this.weaknessId);

		}	
public Vulnerability(long weaknessId, long hashCode, long startLine, long endLine, long startCol, long endCol) {
	super();
	
	this.weaknessId = weaknessId;
	this.hashCode = hashCode;
	this.startLine = startLine;
	this.endLine = endLine;
	this.startCol = startCol;
	this.endCol = endCol;
	this.filename = "VPR-VLN-" + String.valueOf(this.weaknessId);

}

private long weaknessId;
private long hashCode;
private long startLine;
private long endLine;
private long startCol;
private long endCol;
private String filename;
private String method;


/**
* @param args
*/
public static void main(String[] args) {

System.out.println("Hello, Vulnerability Ready");


}

public long getWeaknessId() {
return weaknessId;
}

public void setWeaknessId(long weaknessId) {
this.weaknessId = weaknessId;
}

public long getHashCode() {
return hashCode;
}

public void setHashCode(long hashCode) {
this.hashCode = hashCode;
}

public long getStartLine() {
return startLine;
}

public void setStartLine(long startLine) {
this.startLine = startLine;
}

public long getEndLine() {
return endLine;
}

public void setEndLine(long endLine) {
this.endLine = endLine;
}

public long getStartCol() {
return startCol;
}

public void setStartCol(long startCol) {
this.startCol = startCol;
}


public String getMethod() {
return method;
}

public void setMethod(String method) {
this.method = method;
}



public long getEndCol() {
return endCol;
}

public void setEndCol(long endCol) {
this.endCol = endCol;
}

public long post() {
JSONObject vlnout = new JSONObject();
vlnout.put("WeaknessID", this.weaknessId);
vlnout.put("Method", this.method);
vlnout.put("Hashcode", this.hashCode);
vlnout.put("StartLine",this.startLine);
vlnout.put("EndLine", this.endLine);
vlnout.put("StartCol",this.startCol);
vlnout.put("EndCol",this.endCol);
        try (FileWriter file = new FileWriter(this.filename)) {
           file.append(vlnout.toString());
   } catch (IOException e) {
           e.printStackTrace();
   }
return 0;
}

public void initMethodBlock(long weaknessID, String methodname) {
	this.weaknessId = weaknessID;
	this.method = methodname;
	this.hashCode = 0;
	this.startLine = 0;
	this.endLine = 00;
	this.startCol = 0;
	this.endCol = 0;
	this.filename = "VPR-VLN-" + String.valueOf(this.weaknessId);	
}

public long print() {
System.out.println("Weakness ID " + this.weaknessId + " ID: " + this.hashCode + " @ line:"+this.startLine + " Col:"+this.startCol+" EndLine:"+ this.endLine + " Col:"+endCol);
return 0;
}

/**
* @return the filename
*/
public String getFilename() {
return filename;
}


}